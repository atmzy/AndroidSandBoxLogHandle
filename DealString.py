# x = r'49f4dce8ff25b90906e0fa1d41295733: E:\android\datasets\SandDroidApks\com.duowan.lolbox.apk246a45f90754ebd8d9acda1ce37c1d96: E:\android\datasets\SandDroidApks\com.duowan.mobile.apk77ec9a60c76a00bc2989520f6c3fd2a9: E:\android\datasets\SandDroidApks\com.facebook.orca.apk51e205f5665047502a77c3b518439766: E:\android\datasets\SandDroidApks\com.famulei.famulei.apk8f8713c5ddb0d044670128b2a936c693: E:\android\datasets\SandDroidApks\com.fanli.android.young.apps.apk46868d8b071fbfef13d3a2d59de2e790: E:\android\datasets\SandDroidApks\com.fingers.yuehan.apk5ef93f6212ddf2d42b6487430e6279af: E:\android\datasets\SandDroidApks\com.fmmatch.zxf.apkd1250c39ba090dab22ba782c4f1b7ce7: E:\android\datasets\SandDroidApks\com.freshfresh.activity.apk1e1249717e058bfcc1036ac4f4ffd772: E:\android\datasets\SandDroidApks\com.gome.eshopnew.apk7a267be408e65cdc8137840d6620cec1: E:\android\datasets\SandDroidApks\com.google.android.apps.plus.apk78a30b68d8d37e1a95a8fd57c95e93d2: E:\android\datasets\SandDroidApks\com.google.android.googlequicksearchbox.apk4de0627f3bce0b0feb82bfe8ac8bdce0: E:\android\datasets\SandDroidApks\com.google.android.street.apk6d481d65ab0764e9b8762d5dd42ab650: E:\android\datasets\SandDroidApks\com.google.android.talk.apkab849811f80d548d98af1b04e62d66f1: E:\android\datasets\SandDroidApks\com.google.android.tts.apk02f337fedafa235514940ece046208fc: E:\android\datasets\SandDroidApks\com.immomo.momo.apk79ac21b2bcdb6002091f66e266d4258e: E:\android\datasets\SandDroidApks\com.ishehui.moneytree.apkfd4fa613ad7043837fe1ccdad6f37be2: E:\android\datasets\SandDroidApks\com.jd.wxsq.app.apk2e07d4257341a1380065ec0c1e514b4b: E:\android\datasets\SandDroidApks\com.jetsun.haobolisten.apk9f71d96ca3f23fd866275ae6d278d29a: E:\android\datasets\SandDroidApks\com.jhd.help.apk710d99ed7af9aed399fdecfd46164c16: E:\android\datasets\SandDroidApks\com.jimonannvjiaoyou.main.apk6255e8235c643e7781469555c909fbd9: E:\android\datasets\SandDroidApks\com.jingdong.app.mall.apka6f2d7c4815b60f4adb1c542e02993d3: E:\android\datasets\SandDroidApks\com.jinpinjiukuaijiu.apkf962d62391919a903620bf8586d64fc1: E:\android\datasets\SandDroidApks\com.jinying.gmall.apkdd1be9c03673ce8c4dd1d8bff68e5478: E:\android\datasets\SandDroidApks\com.jinying.mobile.apk801dbd8df9955a170a208e040576197f: E:\android\datasets\SandDroidApks\com.jm.android.jumei.apk92fae21db9260f39e8c11d376258bd87: E:\android\datasets\SandDroidApks\com.jshjw.preschool.mobile.apk6870164a8ddef380e628691b11c2fba5: E:\android\datasets\SandDroidApks\com.juanpi.ui.apkc0fb888e6fa4e5cad8f706e9d1867037: E:\android\datasets\SandDroidApks\com.jym.mall.apk1f7fbc24a7731eb65047fa96c3e3666f: E:\android\datasets\SandDroidApks\com.kaixin001.activity.apkbac4734c6015ab873c92adf5a4b9f6bd: E:\android\datasets\SandDroidApks\com.lehai.ui.apkb15f8eb747199c50a1ece85c81a9fe27: E:\android\datasets\SandDroidApks\com.maochao.wowozhe.apkd85eff0e4b85d9e82cf154d4bfb0f9b1: E:\android\datasets\SandDroidApks\com.media8s.beauty.ui.apk4f76192adaf845af1310975dee9088b2: E:\android\datasets\SandDroidApks\com.meilapp.meila.apk756ba000713b55ab151cc2a6d9b1798f: E:\android\datasets\SandDroidApks\com.meilishuo.apk38452eaf3e04215666d9319a2686a400: E:\android\datasets\SandDroidApks\com.meitu.facefactory.apk10aca7bff8751b243b53f0c67374f1a9: E:\android\datasets\SandDroidApks\com.meiying.jiukuaijiu.apk0e6a5f614a96eeb142e26f40a05077b5: E:\android\datasets\SandDroidApks\com.melot.meshow.apkf739845328d8c4cdc4022af4548c19c2: E:\android\datasets\SandDroidApks\com.memezhibo.android.apkafb9279cfacdf673cde57bfbd82aca4b: E:\android\datasets\SandDroidApks\com.miaozandashi.apk959a159f9e1bbe8430fada1fa36ede52: E:\android\datasets\SandDroidApks\com.mll.apk8ea1a8bcd2927c25af4c2ec926d66f03: E:\android\datasets\SandDroidApks\com.mobimtech.natives.ivp.apk3e44fb407d485a2eeee5d5f7facac125: E:\android\datasets\SandDroidApks\com.mogujie.apkbc7c50f7e1f69d109da9e48320761f06: E:\android\datasets\SandDroidApks\com.myhoney.apk9b3ff36670638bdf2c40731ecc5e3839: E:\android\datasets\SandDroidApks\com.pipipifa.pilaipiwang.apkbee1f52d315764f4a850c2d176ff0c54: E:\android\datasets\SandDroidApks\com.qiuai.shengmao.main.apkdead0c85bc679a3191931fab0d80b75e: E:\android\datasets\SandDroidApks\com.qiulianai.main.apkf35f30cad305b318714259dbdd7bc1e9: E:\android\datasets\SandDroidApks\com.qufenqi.android.app.apkee1f5b7ec1090ac7d92ffbf15635046c: E:\android\datasets\SandDroidApks\com.qzone.apk7a06dc366f838358d4798848cf09f8ca: E:\android\datasets\SandDroidApks\com.reliantongcheng.main.apk3e9c92325a74ee3c22b59fc2d4c90595: E:\android\datasets\SandDroidApks\com.renren.mobile.android.apk5f8ba070e6fcd00b5ccd9b1fffe0ef2a: E:\android\datasets\SandDroidApks\com.renren.mobile.apad.apk9c765471f559d509568dcfa829910c92: E:\android\datasets\SandDroidApks\com.sangdh.apk7298c18b8aa8ec57efa53347af56cb42: E:\android\datasets\SandDroidApks\com.sina.weibo.apkb6c7562a6a1814cd6cdaec30a2f6e8f7: E:\android\datasets\SandDroidApks\com.sino.app.advancedA71849.apkbf4ce2475c8e49eb7f08b58ef75e8ebb: E:\android\datasets\SandDroidApks\com.sino.app.advancedA79427.apk707938c56894974988e40de241593e34: E:\android\datasets\SandDroidApks\com.snda.tt.apk464551667e156b76ab5833ea1c799910: E:\android\datasets\SandDroidApks\com.snda.youni.apk72f9e76b5f8d0e95a88466a96a50db70: E:\android\datasets\SandDroidApks\com.suning.mobile.ebuy.apkd97dd65efc5163cbfc58f0286c1a559f: E:\android\datasets\SandDroidApks\com.taohwu.taohv.apkdaf77d2b7046fe6dd37f5ea9445c495a: E:\android\datasets\SandDroidApks\com.taou.maimai.apk1d5f36756f2641d12ee92686c4d8a24d: E:\android\datasets\SandDroidApks\com.tencent.android.pad.apkfe92bef4c58e5940c2f8009cd8b3dc27: E:\android\datasets\SandDroidApks\com.tencent.mm.apka32c258cb2f23aa146da2920a587c31e: E:\android\datasets\SandDroidApks\com.tencent.mobileqqi.apkb8fc5272c3b032894379b01b8d9085f5: E:\android\datasets\SandDroidApks\com.threeti.yongai.apk6f2667385be4ca9bb92d28aaef0814f5: E:\android\datasets\SandDroidApks\com.tongchenglove.main.apk28fb3a4c4bee876418a7e819b0adc544: E:\android\datasets\SandDroidApks\com.tongchengyeyue.main.apke4dada1c5528d442fe3a3ecd01c949f8: E:\android\datasets\SandDroidApks\com.tuan800.android.apk3b31fbe96586ddeb6368d87955d3dcaa: E:\android\datasets\SandDroidApks\com.tuan800.tao800.apk51c3ae904a388c06241ee921a407df8e: E:\android\datasets\SandDroidApks\com.twoba.taoke.apkff448845330059bd67103e5dd270a07e: E:\android\datasets\SandDroidApks\com.unique.app.apk5e7e97b02d9362da34a2558900bfb7d0: E:\android\datasets\SandDroidApks\com.vehicles.activities.apk92832daaa78e1f902009b4af977b3850: E:\android\datasets\SandDroidApks\com.vip.hd.apk2293eeb4888dc0f357df1e899bc1faa6: E:\android\datasets\SandDroidApks\com.vipshop.vshhc.apka0099d48ee33b032db93aa342aff863d: E:\android\datasets\SandDroidApks\com.wbiao.wbapp.apkc9cfc06cdcbea239772dc9c697a0b595: E:\android\datasets\SandDroidApks\com.wealike.frame.apkdeb91a5cfa2133f826083d2236c5c786: E:\android\datasets\SandDroidApks\com.weiju.apkafba8099b4d5875c9da7540e257dadaf: E:\android\datasets\SandDroidApks\com.yaoshiwiifwann.apk11b443926e5f36fda5681048cf443eb3: E:\android\datasets\SandDroidApks\com.yek.lafaso.apk1925e13bc8558b1db3842befba7a2da3: E:\android\datasets\SandDroidApks\com.yike.iwuse.apk2320a71c1a62e38a8c71254d31324f13: E:\android\datasets\SandDroidApks\com.yintai.apk34d53f992e28aa592fa726be50a238a8: E:\android\datasets\SandDroidApks\com.yougou.apkffce3fc384a69b2cf9c8605df84cdb5e: E:\android\datasets\SandDroidApks\com.yourdream.app.android.apk2fc599eb535fb7187b4636db22ad990d: E:\android\datasets\SandDroidApks\com.youshixiu.rectools.apkfd711e5c4992e207f543edc844ace34a: E:\android\datasets\SandDroidApks\com.youyuan.lrxq.apk78a9ae06b380019c6cea59e3e43fe41f: E:\android\datasets\SandDroidApks\com.youyuan.yyhl.apkef1b41dcfa22623b916308ccce9b0987: E:\android\datasets\SandDroidApks\com.youzhi.citydiscount.apk0e8c8cdd99f29ecf0a70a30e72dff875: E:\android\datasets\SandDroidApks\com.yuaishenqi.xiuai.main.apkef89ec31dc6069598b41d6b1519e0767: E:\android\datasets\SandDroidApks\com.yunyou.pengyouwan.apk41950b2268b8d75bf3e063b0bc498dc3: E:\android\datasets\SandDroidApks\com.yx.apke41d40530aafe79ad51584ccb7040e65: E:\android\datasets\SandDroidApks\com.zhangdan.app.apkb77f971e78c57f2bb37747b159b9ef6f: E:\android\datasets\SandDroidApks\com.zhiyun.feel.apk07a161ce93d1e6986f1601f00e98f197: E:\android\datasets\SandDroidApks\com.zhouyehuyu.smokefire.apkc32e0eaa26c459a24e824d4c6d544638: E:\android\datasets\SandDroidApks\ls.tongzhuang.namespaces.apk076ba5f8da4926861c83bc14b6a0ffb5: E:\android\datasets\SandDroidApks\me.papa.apk81e5c29955115b4df4b7792e3d3101b3: E:\android\datasets\SandDroidApks\os.xiehou360.im.mei.apk'
# j = 0
# list = []
# for i in range(len(x)):
#     if (cmp(x[i], '.') == 0) and (cmp(x[i + 1], 'a') == 0) and (cmp(x[i + 2], 'p') ==0)and (cmp(x[i + 3], 'k') == 0):
#         list.append(x[j:i+4])
#         j = i+4
# for i in list:
#     print i

import json
import os
import pdb

apis = set()
x = '{"fileOper": {"timeStamp": "2016-05-03 13:50:27", "api": "com.android.internal.os.ZygoteInit#main->com.android.internal.os.ZygoteInit$MethodAndArgsCaller#run->java.lang.reflect.Method#invoke->java.lang.reflect.Method#invoke->android.app.ActivityThread#main->android.os.Looper#loop->android.os.Handler#dispatchMessage->android.app.ActivityThread$H#handleMessage->android.app.ActivityThread#access$1500->android.app.ActivityThread#handleBindApplication->android.app.LoadedApk#makeApplication->android.app.Instrumentation#newApplication->android.app.Instrumentation#newApplication->android.app.Application#attach->com.uc.browser.UCMobileApp#attachBaseContext->com.uc.dynamicload.b#a->com.uc.dynamicload.framework.d.e#a->com.uc.base.util.file.c#c->java.io.File#delete->libcore.io.BlockGuardOs#remove->libcore.io.Posix#remove", "operType": "delete_file", "uid": "10055", "filePath": "/data/data/com.UCMobile.intl/com"}}'


def findapi(x):
    try:
        dataDict = json.loads(x)
    except Exception as ex:
        # pdb.set_trace()
        print 'something wrong in logfile...'
        return

    for k, v in dataDict.items():

        for kk, vv in v.items():
            # print kk
            # print vv
            if kk == 'api':
                strs = vv.split('->')
                api = strs[-1].replace('#', '->')
                if not api in apis:
                    apis.add(api)
                    print 'added api: ' + api


def getlogs(rootpath):
    logspath = []
    paths = os.walk(rootpath)
    for i in paths:
        for filenames in i[2]:
            if filenames.find('.log.filted') > 0:
                p = str(os.path.join(i[0], filenames))
                # print i[0]
                # print filenames
                logspath.append(p)  # str(os.path.join(i[1], filenames))
                # print p
    return logspath


def findApiList(path, apiFilePath):
    # path = r'E:\android\paper related\anti-emulator\logs\sanddroid-4\test-4'
    x = getlogs(path)
    print 'file number is: ' + str(len(x))
    cnt = 0
    for i in x:
        cnt = cnt + 1
        file = open(i, 'r')
        line = file.readline()
        while line:
            findapi(line)
            line = file.readline()
        print 'finished file: ' + str(cnt)
    #
    # apiFile = open('apis.txt', 'wb')
    # for api in apis:
    #     apiFile.write(api + os.linesep)
    # apiFile.close()
    api_list = []
    for api in apis:
        api_list.append(api)
    api_list.sort()
    apiFile = open(apiFilePath, 'wb')
    for api in api_list:
        apiFile.write(api + os.linesep)
    apiFile.close()
